<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>MM2 Tracker PRO</title>

<style>
body {
    margin: 0;
    font-family: Arial;
    color: white;
    text-align: center;
    background: url("fundo.jpg") no-repeat center center fixed;
    background-size: cover;
}

/* glass effect */
.glass {
    backdrop-filter: blur(12px);
    background: rgba(255,255,255,0.1);
    border-radius: 20px;
    padding: 20px;
    margin: 20px;
}

/* bot√µes */
button {
    padding: 10px 18px;
    margin: 5px;
    border-radius: 12px;
    border: none;
    font-size: 16px;
    cursor: pointer;
    color: white;
    background: linear-gradient(135deg, #6a11cb, #2575fc);
    transition: 0.2s;
}

button:hover {
    transform: scale(1.1);
}

/* bot√µes transparentes estilo apple */
.btn-glass {
    background: rgba(255,255,255,0.15);
}

/* contador */
#contador {
    font-size: 60px;
    margin: 20px;
}

/* anima√ß√£o */
.flash {
    animation: pop 0.2s;
}
@keyframes pop {
    0% {transform: scale(1);}
    50% {transform: scale(1.3);}
    100% {transform: scale(1);}
}

input {
    padding: 8px;
    border-radius: 10px;
    border: none;
    text-align: center;
}

#app { display: none; }
</style>
</head>

<body>

<div id="login" class="glass">
    <h2>Login / Registro</h2>
    <input id="user" placeholder="Usu√°rio"><br><br>
    <input id="pass" type="password" placeholder="Senha"><br><br>
    <button onclick="registrar()">Registrar</button>
    <button onclick="logar()">Entrar</button>
</div>

<div id="app">

<div class="glass">
    <h2 id="nomeUser"></h2>
    <h3>Vit√≥rias: <span id="wins">0</span></h3>
    <h1 id="contador">0</h1>

    <input id="editar" type="number" placeholder="Editar valor">
    <button onclick="setar()">Setar</button>

    <br>

    <button onclick="add(1)">+1</button>
    <button onclick="add(5)">+5</button>
    <button onclick="add(10)">+10</button>

    <button onclick="add(-1)">-1</button>
    <button onclick="add(-5)">-5</button>
    <button onclick="add(-10)">-10</button>

    <br>

    <button onclick="win()">üèÜ Vit√≥ria</button>
    <button onclick="resetar()">Reset</button>
</div>

<div class="glass">
    <button class="btn-glass" onclick="toggleSom()">üîä Som</button>
    <button class="btn-glass" onclick="verHistorico()">üìä Hist√≥rico</button>
    <button class="btn-glass" onclick="ranking()">üèÜ Ranking</button>
    <button class="btn-glass" onclick="logout()">üö™ Sair</button>
</div>

<div id="historico" class="glass"></div>

</div>

<audio id="som">
    <source src="https://www.soundjay.com/button/sounds/button-3.mp3">
</audio>

<script>

// estado
let userAtual = null;
let somLigado = true;

// login autom√°tico
if(localStorage.getItem("logado")) {
    entrarApp(localStorage.getItem("logado"));
}

// registrar
function registrar(){
    let u = user.value;
    let p = pass.value;

    if(!u || !p) return alert("Preencha tudo");

    localStorage.setItem("user_"+u, JSON.stringify({
        senha: p,
        contador: 0,
        wins: 0,
        historico: []
    }));

    alert("Registrado!");
}

// login
function logar(){
    let u = user.value;
    let p = pass.value;

    let dados = JSON.parse(localStorage.getItem("user_"+u));

    if(!dados || dados.senha != p) {
        alert("Erro no login");
        return;
    }

    localStorage.setItem("logado", u);
    entrarApp(u);
}

// entrar no app
function entrarApp(u){
    userAtual = u;
    login.style.display = "none";
    app.style.display = "block";
    nomeUser.innerText = "Jogador: " + u;

    carregar();
}

// logout
function logout(){
    localStorage.removeItem("logado");
    location.reload();
}

// carregar dados
function carregar(){
    let d = JSON.parse(localStorage.getItem("user_"+userAtual));
    contador.innerText = d.contador;
    wins.innerText = d.wins;
}

// salvar
function salvar(d){
    localStorage.setItem("user_"+userAtual, JSON.stringify(d));
}

// add
function add(v){
    let d = JSON.parse(localStorage.getItem("user_"+userAtual));
    d.contador += v;
    if(d.contador < 0) d.contador = 0;

    salvar(d);
    atualizar(d);
    animar();
}

// vit√≥ria
function win(){
    let d = JSON.parse(localStorage.getItem("user_"+userAtual));
    d.wins++;
    salvar(d);
    atualizar(d);
}

// set manual
function setar(){
    let v = parseInt(editar.value);
    if(isNaN(v)) return;

    let d = JSON.parse(localStorage.getItem("user_"+userAtual));
    d.contador = v;
    salvar(d);
    atualizar(d);
}

// reset
function resetar(){
    let d = JSON.parse(localStorage.getItem("user_"+userAtual));

    let hoje = new Date().toLocaleDateString();
    d.historico.push({data: hoje, partidas: d.contador});

    d.contador = 0;

    salvar(d);
    atualizar(d);
}

// atualizar tela
function atualizar(d){
    contador.innerText = d.contador;
    wins.innerText = d.wins;
}

// hist√≥rico
function verHistorico(){
    let d = JSON.parse(localStorage.getItem("user_"+userAtual));

    historico.innerHTML = "<h3>Hist√≥rico</h3>";

    d.historico.forEach(h=>{
        historico.innerHTML += `<p>${h.data} - ${h.partidas}</p>`;
    });
}

// ranking
function ranking(){
    let lista = [];

    for(let i=0;i<localStorage.length;i++){
        let k = localStorage.key(i);
        if(k.startsWith("user_")){
            let d = JSON.parse(localStorage.getItem(k));
            lista.push({nome:k.replace("user_",""), wins:d.wins});
        }
    }

    lista.sort((a,b)=>b.wins-a.wins);

    historico.innerHTML = "<h3>Ranking</h3>";

    lista.forEach((u,i)=>{
        historico.innerHTML += `<p>${i+1}¬∫ ${u.nome} - ${u.wins}</p>`;
    });
}

// som
function toggleSom(){
    somLigado = !somLigado;
    localStorage.setItem("som", somLigado);
}

// tocar som
function playSom(){
    if(somLigado){
        document.getElementById("som").play();
    }
}

// anima√ß√£o
function animar(){
    contador.classList.add("flash");
    playSom();
    setTimeout(()=>contador.classList.remove("flash"),200);
}

// carregar prefer√™ncia de som
if(localStorage.getItem("som") !== null){
    somLigado = localStorage.getItem("som") === "true";
}

// reset autom√°tico meia noite
setInterval(()=>{
    let agora = new Date();
    if(agora.getHours() == 0 && agora.getMinutes() == 0){
        resetar();
    }
},60000);

</script>

</body>
</html>
